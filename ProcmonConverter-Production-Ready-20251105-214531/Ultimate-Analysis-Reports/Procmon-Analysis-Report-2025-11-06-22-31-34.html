<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Procmon Professional Analysis Report - 2025-11-06-22-31-34</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables with Bootstrap 5 -->
    <link href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.bootstrap5.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Gates Foundation Theme Variables */
        :root[data-theme="light"] {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e8e9eb;
            --text-primary: #2c3e50;
            --text-secondary: #64748b;
            --border-color: #cbd5e1;
            --card-bg: #ffffff;
            --modal-bg: #ffffff;
            --modal-overlay: rgba(0, 0, 0, 0.5);
            --primary-gradient: linear-gradient(135deg, #475569 0%, #334155 100%);
            --primary-solid: #475569;
            --primary-hover: #334155;
            --accent-orange: #d97706;
            --accent-orange-hover: #b45309;
            --card-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.08);
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        :root[data-theme="dark"] {
            --bg-primary: #1e293b;
            --bg-secondary: #334155;
            --bg-tertiary: #475569;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --border-color: #475569;
            --card-bg: #334155;
            --modal-bg: #334155;
            --modal-overlay: rgba(0, 0, 0, 0.75);
            --primary-gradient: linear-gradient(135deg, #64748b 0%, #475569 100%);
            --primary-solid: #64748b;
            --primary-hover: #475569;
            --accent-orange: #fb923c;
            --accent-orange-hover: #f97316;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.4), 0 2px 4px rgba(0,0,0,0.25);
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        * { transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg-primary); color: var(--text-primary); }
        .metric-card { background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--card-shadow); color: var(--text-primary); }
        .metric-card .value { font-size: 2rem; font-weight: 700; color: var(--primary-solid); }
        .metric-card .label { font-size: 0.875rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; margin-top: 0.5rem; }
        .table-container { background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--card-shadow); margin-bottom: 2rem; color: var(--text-primary); }
        .chart-container { background: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: var(--card-shadow); min-height: 400px; }
        thead th { background-color: var(--bg-tertiary) !important; color: var(--text-primary) !important; font-weight: 600; padding: 0.5rem; }
        /* Column Filter Dropdowns with Checkboxes */
        .column-filter-btn { width: 100%; padding: 0.5rem 0.75rem; border: 2px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; background-color: var(--card-bg); color: var(--text-primary); font-weight: 500; cursor: pointer; transition: var(--transition-smooth); text-align: left; display: flex; justify-content: space-between; align-items: center; }
        .column-filter-btn:hover { border-color: var(--primary-solid); box-shadow: 0 0 0 0.15rem rgba(79, 70, 229, 0.15); }
        .column-filter-dropdown { position: absolute; top: 100%; left: 0; right: 0; background: var(--card-bg); border: 2px solid var(--border-color); border-radius: 6px; max-height: 300px; overflow-y: auto; z-index: 1000; display: none; box-shadow: var(--card-shadow); margin-top: 0.25rem; }
        .column-filter-dropdown.show { display: block; }
        .filter-option { padding: 0.5rem 0.75rem; display: flex; align-items: center; cursor: pointer; transition: background-color 0.2s; }
        .filter-option:hover { background-color: var(--bg-tertiary); }
        .filter-option input[type="checkbox"] { margin-right: 0.5rem; cursor: pointer; }
        .filter-option label { cursor: pointer; flex-grow: 1; margin: 0; color: var(--text-primary); }
        .filter-search { padding: 0.5rem; border-bottom: 1px solid var(--border-color); }
        .filter-search input { width: 100%; padding: 0.25rem 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; background: var(--bg-primary); color: var(--text-primary); }
        .filter-actions { padding: 0.5rem; border-top: 1px solid var(--border-color); display: flex; gap: 0.5rem; }
        .filter-actions button { flex: 1; padding: 0.25rem 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; background: var(--card-bg); color: var(--text-primary); cursor: pointer; font-size: 0.75rem; }
        .filter-actions button:hover { background: var(--bg-tertiary); }
        .filter-count { display: inline-block; margin-left: 0.5rem; background: var(--primary-solid); color: white; padding: 0.125rem 0.5rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; }
        .table { margin-bottom: 0; color: var(--text-primary); }
        .dt-buttons { margin-bottom: 0.75rem; }
        .dt-button { margin-left: 0.5rem !important; }
        #clearFiltersBtn { margin-top: 0.25rem; }
        /* Row Selection Styles */
        .table tbody tr { cursor: pointer; transition: background-color 0.2s ease; }
        .table tbody tr:hover { background-color: rgba(102, 126, 234, 0.1) !important; }
        .table tbody tr:active { background-color: rgba(102, 126, 234, 0.2) !important; }
        /* Detail View Modal */
        .detail-modal .modal-dialog { max-width: 800px; }
        .detail-modal .modal-content { background: var(--modal-bg); color: var(--text-primary); }
        .detail-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; }
        .detail-item { background: var(--bg-tertiary); padding: 0.75rem; border-radius: 6px; border-left: 3px solid var(--primary-solid); }
        .detail-item .label { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.25rem; }
        .detail-item .value { font-size: 0.95rem; color: var(--text-primary); font-family: "Courier New", monospace; word-break: break-all; }
        /* Chart Thumbnail Styles */
        .chart-thumbnail-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 1rem; }
        .chart-thumbnail { background: var(--card-bg); border-radius: 12px; padding: 1rem; box-shadow: var(--card-shadow); cursor: pointer; transition: var(--transition-smooth); border: 2px solid transparent; }
        .chart-thumbnail:hover { transform: translateY(-4px); box-shadow: 0 8px 24px rgba(0,0,0,0.15); border-color: var(--primary-solid); }
        .chart-thumbnail h5 { margin-bottom: 0.75rem; color: var(--text-primary); font-size: 1rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem; }
        .chart-thumbnail canvas { width: 100% !important; height: 200px !important; }
        .chart-thumbnail-badge { background: var(--primary-solid); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; }
        /* DataTables Dark Mode */
        :root[data-theme="dark"] .dataTables_wrapper { color: var(--text-primary); }
        :root[data-theme="dark"] .dataTable thead th { background-color: var(--bg-tertiary) !important; color: var(--text-primary) !important; }
        :root[data-theme="dark"] .dataTable tbody tr { background-color: var(--card-bg); color: var(--text-primary); }
        :root[data-theme="dark"] .dataTable tbody tr:hover { background-color: var(--bg-tertiary) !important; }
        :root[data-theme="dark"] .dataTables_info, :root[data-theme="dark"] .dataTables_length label, :root[data-theme="dark"] .dataTables_filter label { color: var(--text-primary); }
        :root[data-theme="dark"] .dataTables_paginate .page-link { background-color: var(--card-bg); border-color: var(--border-color); color: var(--text-primary); }
        :root[data-theme="dark"] .dataTables_paginate .page-link:hover { background-color: var(--bg-tertiary); border-color: var(--primary-solid); }
        :root[data-theme="dark"] .dataTables_paginate .page-item.active .page-link { background-color: var(--primary-solid); border-color: var(--primary-solid); }
        /* Modal Dark Mode */
        :root[data-theme="dark"] .modal-content { background: var(--modal-bg); color: var(--text-primary); border-color: var(--border-color); }
        :root[data-theme="dark"] .modal-header { border-bottom-color: var(--border-color); }
        :root[data-theme="dark"] .modal-footer { border-top-color: var(--border-color); }
        :root[data-theme="dark"] .btn-close { filter: invert(1); }
    </style>
</head>
<body>
    <div class="hero-header" style="background: var(--primary-gradient); color: white; padding: 2rem;">
        <div class="d-flex justify-content-between align-items-center">
            <h1>Procmon Professional Analysis - 2025-11-06-22-31-34</h1>            <button id="themeToggle" class="btn btn-outline-light btn-sm">
                <i class="fas fa-moon" id="darkIcon"></i>
                <i class="fas fa-sun" id="lightIcon" style="display:none;"></i>
                <span id="themeText" class="ms-2">Dark Mode</span>
            </button>
        </div>
    </div>
    <div class="container-fluid py-4">
        <div class="row g-4 mb-4">
            <div class="col-md-3"><div class="metric-card"><div class="value">267,374</div><div class="label">Total Records</div></div></div>            <div class="col-md-3"><div class="metric-card"><div class="value">2</div><div class="label">Files Processed</div></div></div>            <div class="col-md-3"><div class="metric-card"><div class="value">267374</div><div class="label">Unique Processes</div></div></div>            <div class="col-md-3"><div class="metric-card"><div class="value">74</div><div class="label">Operation Types</div></div></div>        </div>
        <!-- 6-Tab Navigation Structure -->
        <ul class="nav nav-tabs" id="reportTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="tab-summary-btn" data-bs-toggle="tab" data-bs-target="#tab-summary" type="button" role="tab">
                    <i class="fas fa-briefcase me-2"></i>Executive Summary
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="tab-patterns-btn" data-bs-toggle="tab" data-bs-target="#tab-patterns" type="button" role="tab">
                    <i class="fas fa-brain me-2"></i>Pattern Recognition
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="tab-analytics-btn" data-bs-toggle="tab" data-bs-target="#tab-analytics" type="button" role="tab">
                    <i class="fas fa-chart-line me-2"></i>Advanced Analytics
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="tab-ml-btn" data-bs-toggle="tab" data-bs-target="#tab-ml" type="button" role="tab">
                    <i class="fas fa-robot me-2"></i>ML Analytics
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="tab-events-btn" data-bs-toggle="tab" data-bs-target="#tab-events" type="button" role="tab">
                    <i class="fas fa-table me-2"></i>Event Details
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="tab-charts-btn" data-bs-toggle="tab" data-bs-target="#tab-charts" type="button" role="tab">
                    <i class="fas fa-chart-pie me-2"></i>Charts
                </button>
            </li>
        </ul>

        <div class="tab-content mt-4" id="reportTabContent">

            <!-- Tab 1: Executive Summary -->
            <div class="tab-pane fade show active" id="tab-summary" role="tabpanel">
                <div class="row g-4">
                    <div class="col-md-12">
                        <div class="table-container">
                            <h3><i class="fas fa-briefcase me-2"></i>Executive Summary</h3>
                            <div class="alert alert-info"><strong>Health Score:</strong> 100.0/100</div>                            <h5 class="mt-4">Key Insights</h5>
                            <ul class="list-group">
                                <li class="list-group-item">System performing well with low error rate: 0%</li>                            </ul>
                            <h5 class="mt-4">Recommendations</h5>
                            <ul class="list-group">
                                <li class="list-group-item">System health is good - continue monitoring</li>                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 2: Pattern Recognition -->
            <div class="tab-pane fade" id="tab-patterns" role="tabpanel">
                <div class="row g-4">
                    <div class="col-md-12">
                        <div class="table-container">
                            <h3><i class="fas fa-brain me-2"></i>Pattern Recognition Analysis</h3>
                            <p class="lead">Detected 0 patterns across the dataset</p>                            <h5 class="mt-4">Detected Patterns</h5>
                            <div class="row">
                            </div>
                            <h5 class="mt-4">Process Clusters</h5>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <div class="metric-card">
                                        <div class="label">System Critical Activity Processes</div>                                        <div class="value">0</div>                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="metric-card">
                                        <div class="label">Standard Operations Activity Processes</div>                                        <div class="value">267374</div>                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="metric-card">
                                        <div class="label">Background Tasks Activity Processes</div>                                        <div class="value">0</div>                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 3: Advanced Analytics -->
            <div class="tab-pane fade" id="tab-analytics" role="tabpanel">
                <div class="row g-4">
                    <div class="col-md-12">
                        <div class="table-container">
                            <h3><i class="fas fa-chart-line me-2"></i>Advanced Analytics</h3>
                            <div class="row mb-4">
                                <div class="col-md-3"><div class="metric-card"><div class="value">267374</div><div class="label">Total Events</div></div></div>                                <div class="col-md-3"><div class="metric-card"><div class="value">0.0%</div><div class="label">Error Rate</div></div></div>                                <div class="col-md-3"><div class="metric-card"><div class="value">0</div><div class="label">Anomalies Detected</div></div></div>                                <div class="col-md-3"><div class="metric-card"><div class="value">Low</div><div class="label">Risk Level</div></div></div>                            </div>
                            <h5 class="mt-4">Anomaly Detection Results</h5>
                            <div class="alert alert-success">No anomalies detected</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 4: ML Analytics -->
            <div class="tab-pane fade" id="tab-ml" role="tabpanel">
                <div class="row g-4">
                    <div class="col-md-12">
                        <div class="table-container">
                            <h3><i class="fas fa-robot me-2"></i>Machine Learning Analytics</h3>
                            <p class="lead">Combined ML/AI insights from pattern recognition and advanced analytics engines</p>
                            <h5 class="mt-4">ML Predictions & Insights</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="alert alert-primary">
                                        <h6>Temporal Analysis</h6>
                                        <p><strong>Trend:</strong> Stable</p>                                        <p><strong>Seasonality:</strong> 0</p>                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="alert alert-success">
                                        <h6>Risk Assessment</h6>
                                        <p><strong>Overall Risk:</strong> Low</p>                                        <p><strong>Risk Score:</strong> 0/100</p>                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 5: Event Details -->
            <div class="tab-pane fade" id="tab-events" role="tabpanel">
                <div class="table-container">
            <h4>Event Details (Showing first 10 records)</h4>            <table class="table table-striped">
                <thead><tr><th>#</th>
                    <th>Time of Day</th>                    <th>Process Name</th>                    <th>PID</th>                    <th>Operation</th>                    <th>Path</th>                    <th>Result</th>                    <th>Detail</th>                    <th>Duration</th>                </thead>
                <tbody>
                    <tr><td>1</td>                        <td>12:00:01.1234567 PM</td>                        <td>System</td>                        <td>4</td>                        <td>RegQueryKey</td>                        <td>HKLM\Software\Microsoft</td>                        <td>SUCCESS</td>                        <td>Length: 256</td>                        <td>0.0000123</td>                    </tr>
                    <tr><td>2</td>                        <td>12:00:02.2345678 PM</td>                        <td>explorer.exe</td>                        <td>1234</td>                        <td>CreateFile</td>                        <td>C:\Windows\explorer.exe</td>                        <td>SUCCESS</td>                        <td>Desired Access: Read</td>                        <td>0.0001234</td>                    </tr>
                    <tr><td>3</td>                        <td>12:00:03.3456789 PM</td>                        <td>chrome.exe</td>                        <td>5678</td>                        <td>ReadFile</td>                        <td>C:\Users\test\file.txt</td>                        <td>ACCESS DENIED</td>                        <td></td>                        <td>0.0000567</td>                    </tr>
                    <tr><td>4</td>                        <td>12:00:04.4567890 PM</td>                        <td>powershell.exe</td>                        <td>9012</td>                        <td>WriteFile</td>                        <td>C:\Temp\output.log</td>                        <td>SUCCESS</td>                        <td>Bytes: 1024</td>                        <td>0.0002345</td>                    </tr>
                    <tr><td>5</td>                        <td>12:00:05.5678901 PM</td>                        <td>System</td>                        <td>4</td>                        <td>RegSetValue</td>                        <td>HKLM\System\Config</td>                        <td>SUCCESS</td>                        <td>Type: REG_DWORD</td>                        <td>0.0000089</td>                    </tr>
                    <tr><td>6</td>                        <td>12:00:06.6789012 PM</td>                        <td>svchost.exe</td>                        <td>3456</td>                        <td>CreateFile</td>                        <td>C:\Windows\System32\file.dll</td>                        <td>NAME NOT FOUND</td>                        <td></td>                        <td>0.0000456</td>                    </tr>
                    <tr><td>7</td>                        <td>12:00:07.7890123 PM</td>                        <td>explorer.exe</td>                        <td>1234</td>                        <td>QueryDirectory</td>                        <td>C:\Users\test\*</td>                        <td>SUCCESS</td>                        <td>Filter: *.*</td>                        <td>0.0001123</td>                    </tr>
                    <tr><td>8</td>                        <td>12:00:08.8901234 PM</td>                        <td>chrome.exe</td>                        <td>5678</td>                        <td>RegQueryKey</td>                        <td>HKCU\Software\Google</td>                        <td>SUCCESS</td>                        <td>Length: 128</td>                        <td>0.0000234</td>                    </tr>
                    <tr><td>9</td>                        <td>12:00:09.9012345 PM</td>                        <td>System</td>                        <td>4</td>                        <td>CreateFile</td>                        <td>C:\pagefile.sys</td>                        <td>SHARING VIOLATION</td>                        <td></td>                        <td>0.0000678</td>                    </tr>
                    <tr><td>10</td>                        <td>12:00:10.0123456 PM</td>                        <td>powershell.exe</td>                        <td>9012</td>                        <td>RegQueryValue</td>                        <td>HKLM\Software\Test</td>                        <td>SUCCESS</td>                        <td>Type: REG_SZ</td>                        <td>0.0000345</td>                    </tr>
                </tbody>
            </table>
                </div>
            </div>

            <!-- Tab 6: Charts -->
            <div class="tab-pane fade" id="tab-charts" role="tabpanel">
                <div class="chart-container">
                    <h3 class="mb-3"><i class="fas fa-chart-bar me-2"></i>Data Visualizations</h3>
                    <div class="chart-thumbnail-container">
                        <div class="chart-thumbnail" data-bs-toggle="modal" data-bs-target="#processChartModal">
                            <h5><i class="fas fa-chart-bar me-2"></i>Process Distribution <span class="chart-thumbnail-badge">Click to expand</span></h5>
                            <canvas id="processThumbnail" data-labels="'11:18:35.5191581 AM','11:18:34.1834834 AM','11:18:35.8705804 AM','11:18:35.4242116 AM','11:18:34.3938880 AM','11:18:35.3246167 AM','11:18:37.5962777 AM','11:18:36.9876745 AM','11:18:37.5791701 AM','11:18:37.4579697 AM','11:18:35.9077991 AM','11:18:37.9411927 AM','11:18:35.6653460 AM','11:18:35.2227603 AM','11:18:36.9800166 AM'" data-data="1,1,1,1,1,1,1,1,1,1,1,1,1,1,1"></canvas>                        </div>
                        <div class="chart-thumbnail" data-bs-toggle="modal" data-bs-target="#operationChartModal">
                            <h5><i class="fas fa-chart-pie me-2"></i>Operation Distribution <span class="chart-thumbnail-badge">Click to expand</span></h5>
                            <canvas id="operationThumbnail" data-labels="'svchost.exe','wmiprvse.exe','System','TaniumCX.exe','lsass.exe','MonitoringHost.exe','vmms.exe','MsMpEng.exe','powershell.exe','newrelic-infra.exe','TaniumTSDB.exe','gc_extension_service.exe','MsSense.exe','nr-winpkg.exe','vmwp.exe'" data-data="131499,117722,4990,4384,3140,1914,997,689,598,544,122,102,94,84,81"></canvas>                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Process Chart Modal -->
        <div class="modal fade" id="processChartModal" tabindex="-1">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Top Processes Distribution</h5>
                        <div class="btn-group btn-group-sm ms-3" role="group">
                            <button type="button" class="btn btn-outline-primary chart-type-btn" data-chart="process" data-type="bar">Bar</button>
                            <button type="button" class="btn btn-outline-primary chart-type-btn" data-chart="process" data-type="pie">Pie</button>
                            <button type="button" class="btn btn-outline-primary chart-type-btn" data-chart="process" data-type="doughnut">Doughnut</button>
                        </div>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <canvas id="processChart" data-labels="'11:18:35.5191581 AM','11:18:34.1834834 AM','11:18:35.8705804 AM','11:18:35.4242116 AM','11:18:34.3938880 AM','11:18:35.3246167 AM','11:18:37.5962777 AM','11:18:36.9876745 AM','11:18:37.5791701 AM','11:18:37.4579697 AM','11:18:35.9077991 AM','11:18:37.9411927 AM','11:18:35.6653460 AM','11:18:35.2227603 AM','11:18:36.9800166 AM'" data-data="1,1,1,1,1,1,1,1,1,1,1,1,1,1,1" style="max-height: 500px;"></canvas>                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="downloadProcessChart"><i class="fas fa-download"></i> Download PNG</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Operation Chart Modal -->
        <div class="modal fade" id="operationChartModal" tabindex="-1">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Top Operations Distribution</h5>
                        <div class="btn-group btn-group-sm ms-3" role="group">
                            <button type="button" class="btn btn-outline-success chart-type-btn" data-chart="operation" data-type="bar">Bar</button>
                            <button type="button" class="btn btn-outline-success chart-type-btn" data-chart="operation" data-type="pie">Pie</button>
                            <button type="button" class="btn btn-outline-success chart-type-btn" data-chart="operation" data-type="doughnut">Doughnut</button>
                        </div>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <canvas id="operationChart" data-labels="'svchost.exe','wmiprvse.exe','System','TaniumCX.exe','lsass.exe','MonitoringHost.exe','vmms.exe','MsMpEng.exe','powershell.exe','newrelic-infra.exe','TaniumTSDB.exe','gc_extension_service.exe','MsSense.exe','nr-winpkg.exe','vmwp.exe'" data-data="131499,117722,4990,4384,3140,1914,997,689,598,544,122,102,94,84,81" style="max-height: 500px;"></canvas>                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="downloadOperationChart"><i class="fas fa-download"></i> Download PNG</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Row Detail Modal -->
        <div class="modal fade detail-modal" id="rowDetailModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title"><i class="fas fa-info-circle"></i> Event Details</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div id="detailContent" class="detail-content">
                            <!-- Dynamic content will be inserted here -->
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer" style="padding: 2rem; text-align: center; margin-top: 3rem;">
            <p><strong>Generated:</strong> 2025-11-06 16:33:03 | <strong>Computer:</strong> LEIGHSLAPTOP</p>        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables Core -->
    <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>
    <!-- DataTables Extensions -->
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>
    <!-- Export Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.js"></script>
    <!-- Search Enhancement Module -->
    <script src="./Search-Enhancement.js"></script>
    <!-- Dynamic Chart Enhancement -->
    <script src="./Add-DynamicChartScript.js"></script>
    <script>
        $(document).ready(function() {
            // Theme Management
            const root = document.documentElement;
            const themeToggle = document.getElementById("themeToggle");
            const darkIcon = document.getElementById("darkIcon");
            const lightIcon = document.getElementById("lightIcon");
            const themeText = document.getElementById("themeText");

            // Load saved theme or default to light
            const savedTheme = localStorage.getItem("theme") || "light";
            applyTheme(savedTheme);

            function applyTheme(theme) {
                root.setAttribute("data-theme", theme);
                localStorage.setItem("theme", theme);

                if (theme === "dark") {
                    darkIcon.style.display = "none";
                    lightIcon.style.display = "inline";
                    themeText.textContent = "Light Mode";
                } else {
                    darkIcon.style.display = "inline";
                    lightIcon.style.display = "none";
                    themeText.textContent = "Dark Mode";
                }
            }

            // Toggle theme on button click
            themeToggle.addEventListener("click", function() {
                const currentTheme = root.getAttribute("data-theme");
                const newTheme = currentTheme === "light" ? "dark" : "light";
                applyTheme(newTheme);
            });

            // Initialize DataTable with column filters and export buttons
            var table = $(".table").DataTable({
                pageLength: 25,
                lengthMenu: [[10, 25, 50, 100, 500, -1], ["10 rows", "25 rows", "50 rows", "100 rows", "500 rows", "Show all"]],
                order: [[0, "asc"]],
                responsive: true,
                dom: "<\"row mb-3\"<\"col-sm-12 col-md-6\"l><\"col-sm-12 col-md-6 text-end\"B>>" +
                     "<\"row\"<\"col-sm-12 col-md-6\"f><\"col-sm-12 col-md-6 text-end\"<\"clear-filters\">>>" +
                     "<\"row\"<\"col-sm-12\"tr>>" +
                     "<\"row\"<\"col-sm-12 col-md-5\"i><\"col-sm-12 col-md-7\"p>>",
                buttons: [
                    {
                        extend: "excel",
                        text: "<i class=\"fas fa-file-excel\"></i> Excel",
                        className: "btn btn-success btn-sm me-1",
                        title: "Procmon Analysis - " + new Date().toISOString().split("T")[0],
                        exportOptions: { orthogonal: "export" }
                    },
                    {
                        extend: "csv",
                        text: "<i class=\"fas fa-file-csv\"></i> CSV",
                        className: "btn btn-info btn-sm me-1",
                        title: "Procmon Analysis - " + new Date().toISOString().split("T")[0],
                        exportOptions: { orthogonal: "export" }
                    },
                    {
                        extend: "pdf",
                        text: "<i class=\"fas fa-file-pdf\"></i> PDF",
                        className: "btn btn-danger btn-sm me-1",
                        title: "Procmon Analysis",
                        orientation: "landscape",
                        pageSize: "LEGAL",
                        exportOptions: { orthogonal: "export" }
                    },
                    {
                        extend: "copy",
                        text: "<i class=\"fas fa-copy\"></i> Copy",
                        className: "btn btn-secondary btn-sm me-1",
                        exportOptions: { orthogonal: "export" }
                    },
                    {
                        extend: "print",
                        text: "<i class=\"fas fa-print\"></i> Print",
                        className: "btn btn-dark btn-sm",
                        exportOptions: { orthogonal: "export" }
                    }
                ],
                initComplete: function() {
                    // Add column-specific checkbox filter dropdowns
                    this.api().columns().every(function(colIdx) {
                        var column = this;
                        var title = $(column.header()).text();
                        
                        // Create filter container
                        var filterContainer = $("<div style=\"position: relative;\"></div>").appendTo($(column.header()).empty());
                        
                        // Create filter button
                        var filterBtn = $("<button class=\"column-filter-btn\" type=\"button\">" +
                            "<span class=\"filter-text\">" + title + "</span>" +
                            "<i class=\"fas fa-chevron-down\"></i>" +
                            "</button>").appendTo(filterContainer);
                        
                        // Create dropdown
                        var dropdown = $("<div class=\"column-filter-dropdown\"></div>").appendTo(filterContainer);
                        
                        // Add search box
                        var searchBox = $("<div class=\"filter-search\"><input type=\"text\" placeholder=\"Search...\" class=\"filter-search-input\"></div>").appendTo(dropdown);
                        
                        // Create options container
                        var optionsContainer = $("<div class=\"filter-options\"></div>").appendTo(dropdown);
                        
                        // Get unique values sorted
                        var uniqueValues = [];
                        column.data().unique().sort().each(function(d) {
                            if (d) uniqueValues.push(d);
                        });
                        
                        // Add checkbox options
                        uniqueValues.forEach(function(value) {
                            var optionId = "filter_" + colIdx + "_" + value.replace(/[^a-zA-Z0-9]/g, "_");
                            var option = $("<div class=\"filter-option\">" +
                                "<input type=\"checkbox\" id=\"" + optionId + "\" value=\"" + value + "\" checked>" +
                                "<label for=\"" + optionId + "\">" + value + "</label>" +
                                "</div>");
                            optionsContainer.append(option);
                        });
                        
                        // Add action buttons
                        var actions = $("<div class=\"filter-actions\">" +
                            "<button class=\"select-all-btn\">Select All</button>" +
                            "<button class=\"clear-btn\">Clear</button>" +
                            "</div>").appendTo(dropdown);
                        
                        // Toggle dropdown
                        filterBtn.on("click", function(e) {
                            e.stopPropagation();
                            $(".column-filter-dropdown").not(dropdown).removeClass("show");
                            dropdown.toggleClass("show");
                        });
                        
                        // Search functionality
                        searchBox.find("input").on("keyup", function() {
                            var searchTerm = $(this).val().toLowerCase();
                            optionsContainer.find(".filter-option").each(function() {
                                var text = $(this).find("label").text().toLowerCase();
                                $(this).toggle(text.indexOf(searchTerm) > -1);
                            });
                        });
                        
                        // Checkbox change handler
                        optionsContainer.on("change", "input[type=\"checkbox\"]", function() {
                            var selectedValues = [];
                            optionsContainer.find("input[type=\"checkbox\"]:checked").each(function() {
                                selectedValues.push($.fn.dataTable.util.escapeRegex($(this).val()));
                            });
                            
                            // Update filter
                            if (selectedValues.length === uniqueValues.length || selectedValues.length === 0) {
                                column.search("").draw();
                            } else {
                                column.search("^(" + selectedValues.join("|") + ")$", true, false).draw();
                            }
                            
                            // Update button text with count
                            var checkedCount = optionsContainer.find("input[type=\"checkbox\"]:checked").length;
                            if (checkedCount < uniqueValues.length) {
                                filterBtn.find(".filter-text").html(title + " <span class=\"filter-count\">" + checkedCount + "</span>");
                            } else {
                                filterBtn.find(".filter-text").text(title);
                            }
                        });
                        
                        // Select All button
                        actions.find(".select-all-btn").on("click", function(e) {
                            e.stopPropagation();
                            optionsContainer.find("input[type=\"checkbox\"]").prop("checked", true).first().trigger("change");
                        });
                        
                        // Clear button
                        actions.find(".clear-btn").on("click", function(e) {
                            e.stopPropagation();
                            optionsContainer.find("input[type=\"checkbox\"]").prop("checked", false).first().trigger("change");
                        });
                    });
                    
                    // Close dropdowns when clicking outside
                    $(document).on("click", function() {
                        $(".column-filter-dropdown").removeClass("show");
                    });
                    
                    // Add "Clear All Filters" button
                    $("div.clear-filters").html("<button id=\"clearFiltersBtn\" class=\"btn btn-warning btn-sm\"><i class=\"fas fa-eraser\"></i> Clear All Filters</button>");
                    
                    // Initialize Search Enhancement Module
                    if (window.SearchEnhancement) {
                        SearchEnhancement.init(table);
                    }
                }
            });

            // Clear all filters functionality
            $(document).on("click", "#clearFiltersBtn", function() {
                // Reset all column checkbox filters
                table.columns().every(function() {
                    var header = $(this.header());
                    // Check all checkboxes in this column
                    header.find("input[type=\"checkbox\"]").prop("checked", true);
                    // Clear the column search
                    this.search("");
                    // Update button text to remove filter count
                    var title = header.find(".filter-text").text().split(" ")[0];
                    header.find(".filter-text").text(title);
                });
                // Reset main search and redraw
                table.search("").draw();
            });

            // Row click handler for detail view
            $(".table tbody").on("click", "tr", function() {
                var rowData = table.row(this).data();
                if (rowData) {
                    showRowDetails(rowData);
                }
            });

            // Function to display row details in modal
            function showRowDetails(rowData) {
                var detailHtml = "";
                var columnNames = [];
                $(".table thead th").each(function(index) {
                    if (index > 0) {
                        columnNames.push($(this).text().trim().split(" ")[0]);
                    }
                });
                rowData.forEach(function(value, index) {
                    if (index > 0) {
                        var fieldName = columnNames[index - 1] || "Field " + index;
                        var fieldValue = value || "(empty)";
                        detailHtml += "<div class=\"detail-item\">";
                        detailHtml += "  <div class=\"label\">" + fieldName + "</div>";
                        detailHtml += "  <div class=\"value\">" + fieldValue + "</div>";
                        detailHtml += "</div>";
                    }
                });
                $("#detailContent").html(detailHtml);
                $("#rowDetailModal").modal("show");
            }

            // Professional Color Palette
            const colorPalette = [
                "rgba(102, 126, 234, 0.8)", "rgba(118, 75, 162, 0.8)", "rgba(40, 167, 69, 0.8)",
                "rgba(255, 193, 7, 0.8)", "rgba(220, 53, 69, 0.8)", "rgba(23, 162, 184, 0.8)",
                "rgba(108, 117, 125, 0.8)", "rgba(255, 99, 132, 0.8)", "rgba(54, 162, 235, 0.8)",
                "rgba(255, 206, 86, 0.8)", "rgba(75, 192, 192, 0.8)", "rgba(153, 102, 255, 0.8)",
                "rgba(255, 159, 64, 0.8)", "rgba(201, 203, 207, 0.8)", "rgba(255, 99, 71, 0.8)"
            ];

            // Chart instances
            let processChartInstance = null;
            let operationChartInstance = null;
            let processThumbnailInstance = null;
            let operationThumbnailInstance = null;

            // Initialize thumbnail charts on page load
            const processThumbnailCanvas = document.getElementById("processThumbnail");
            if (processThumbnailCanvas) {
                const labels = processThumbnailCanvas.dataset.labels.split(",");
                const data = processThumbnailCanvas.dataset.data.split(",").map(Number);
                processThumbnailInstance = createChart(processThumbnailCanvas, labels, data, "bar", colorPalette[0]);
            }

            const operationThumbnailCanvas = document.getElementById("operationThumbnail");
            if (operationThumbnailCanvas) {
                const labels = operationThumbnailCanvas.dataset.labels.split(",");
                const data = operationThumbnailCanvas.dataset.data.split(",").map(Number);
                operationThumbnailInstance = createChart(operationThumbnailCanvas, labels, data, "doughnut", colorPalette[1]);
            }

            // Initialize charts when modals open
            $("#processChartModal").on("shown.bs.modal", function() {
                if (!processChartInstance) {
                    const canvas = document.getElementById("processChart");
                    const labels = canvas.dataset.labels.split(",");
                    const data = canvas.dataset.data.split(",").map(Number);
                    processChartInstance = createChart(canvas, labels, data, "bar", colorPalette[0]);
                }
            });

            $("#operationChartModal").on("shown.bs.modal", function() {
                if (!operationChartInstance) {
                    const canvas = document.getElementById("operationChart");
                    const labels = canvas.dataset.labels.split(",");
                    const data = canvas.dataset.data.split(",").map(Number);
                    operationChartInstance = createChart(canvas, labels, data, "bar", colorPalette[1]);
                }
            });

            // Create chart function with professional config
            function createChart(canvas, labels, data, type, primaryColor) {
                const colors = type === "bar" ? data.map(() => primaryColor) : colorPalette.slice(0, data.length);
                return new Chart(canvas, {
                    type: type,
                    data: {
                        labels: labels,
                        datasets: [{
                            label: "Event Count",
                            data: data,
                            backgroundColor: colors,
                            borderColor: colors.map(c => c.replace("0.8", "1")),
                            borderWidth: 2,
                            hoverOffset: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: { duration: 1000, easing: "easeInOutQuart" },
                        plugins: {
                            legend: {
                                display: type !== "bar",
                                position: "top",
                                onClick: (e, legendItem, legend) => {
                                    const index = legendItem.index;
                                    const chart = legend.chart;
                                    const meta = chart.getDatasetMeta(0);
                                    meta.data[index].hidden = !meta.data[index].hidden;
                                    chart.update();
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || "";
                                        const value = context.parsed.y || context.parsed;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return label + ": " + value.toLocaleString() + " (" + percentage + "%)";
                                    }
                                }
                            }
                        },
                        scales: type === "bar" ? {
                            y: { beginAtZero: true, ticks: { precision: 0 } }
                        } : {}
                    }
                });
            }

            // Chart type switching
            $(".chart-type-btn").on("click", function() {
                const chartName = $(this).data("chart");
                const newType = $(this).data("type");
                const canvas = document.getElementById(chartName + "Chart");
                const labels = canvas.dataset.labels.split(",");
                const data = canvas.dataset.data.split(",").map(Number);
                const primaryColor = chartName === "process" ? colorPalette[0] : colorPalette[1];

                // Destroy existing chart
                if (chartName === "process" && processChartInstance) {
                    processChartInstance.destroy();
                    processChartInstance = createChart(canvas, labels, data, newType, primaryColor);
                } else if (chartName === "operation" && operationChartInstance) {
                    operationChartInstance.destroy();
                    operationChartInstance = createChart(canvas, labels, data, newType, primaryColor);
                }

                // Update button states
                $(this).siblings().removeClass("active");
                $(this).addClass("active");
            });

            // Download chart as PNG
            $("#downloadProcessChart").on("click", function() {
                if (processChartInstance) {
                    const url = processChartInstance.toBase64Image();
                    const a = document.createElement("a");
                    a.href = url;
                    a.download = "process-chart-" + new Date().toISOString().split("T")[0] + ".png";
                    a.click();
                }
            });

            $("#downloadOperationChart").on("click", function() {
                if (operationChartInstance) {
                    const url = operationChartInstance.toBase64Image();
                    const a = document.createElement("a");
                    a.href = url;
                    a.download = "operation-chart-" + new Date().toISOString().split("T")[0] + ".png";
                    a.click();
                }
            });
        });
    </script>
</body>
</html>

